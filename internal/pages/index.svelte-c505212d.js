import{S as Q,i as X,N as ae,P as fe,w as R,x as N,y as B,q as S,o as V,B as D,F as ce,e as C,k as M,c as y,a as I,d as h,m as T,b as w,O as U,g as v,Q as j,J as de,K as me,L as _e,s as x,R as he,T as z,U as $,V as ee,W as pe,v as ge,X as we,E as te,Y as be,Z as ve,_ as ke,I as F,$ as Ee,a0 as G,t as Ce,h as ye}from"../chunks/vendor-2aee3f9d.js";function Ie(s){let e,t,n,u,f,a;const p=s[3].default,i=ce(p,s,s[4],null);return{c(){e=C("div"),t=M(),n=C("div"),i&&i.c(),this.h()},l(r){e=y(r,"DIV",{class:!0}),I(e).forEach(h),t=T(r),n=y(r,"DIV",{class:!0});var d=I(n);i&&i.l(d),d.forEach(h),this.h()},h(){w(e,"class","background svelte-1jyu0ly"),U(e,"open",s[0]),w(n,"class","modal svelte-1jyu0ly"),U(n,"open",s[0])},m(r,d){v(r,e,d),v(r,t,d),v(r,n,d),i&&i.m(n,null),u=!0,f||(a=j(e,"click",s[1]),f=!0)},p(r,d){d&1&&U(e,"open",r[0]),i&&i.p&&(!u||d&16)&&de(i,p,r,r[4],u?_e(p,r[4],d,null):me(r[4]),null),d&1&&U(n,"open",r[0])},i(r){u||(S(i,r),u=!0)},o(r){V(i,r),u=!1},d(r){r&&h(e),r&&h(t),r&&h(n),i&&i.d(r),f=!1,a()}}}function Me(s){let e,t;return e=new fe({props:{$$slots:{default:[Ie]},$$scope:{ctx:s}}}),{c(){R(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,u){B(e,n,u),t=!0},p(n,[u]){const f={};u&17&&(f.$$scope={dirty:u,ctx:n}),e.$set(f)},i(n){t||(S(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){D(e,n)}}}function Te(s,e,t){let{$$slots:n={},$$scope:u}=e,{open:f=!1}=e,{onClose:a=()=>{}}=e;function p(){t(0,f=!1),a()}return s.$$set=i=>{"open"in i&&t(0,f=i.open),"onClose"in i&&t(2,a=i.onClose),"$$scope"in i&&t(4,u=i.$$scope)},[f,p,a,n,u]}class Ue extends Q{constructor(e){super();X(this,e,Te,Me,ae,{open:0,onClose:2})}}const{window:Y}=we;function Le(s){let e,t,n,u,f,a,p,i,r,d,_,m,k,E,o,g;return a=new be({}),d=new ve({}),k=new ke({}),{c(){e=C("canvas"),t=M(),n=C("video"),u=M(),f=C("button"),R(a.$$.fragment),p=M(),i=C("button"),r=C("span"),R(d.$$.fragment),_=M(),m=C("span"),R(k.$$.fragment),this.h()},l(l){e=y(l,"CANVAS",{width:!0,height:!0,class:!0}),I(e).forEach(h),t=T(l),n=y(l,"VIDEO",{width:!0,height:!0,class:!0}),I(n).forEach(h),u=T(l),f=y(l,"BUTTON",{class:!0});var b=I(f);N(a.$$.fragment,b),b.forEach(h),p=T(l),i=y(l,"BUTTON",{class:!0});var O=I(i);r=y(O,"SPAN",{class:!0});var W=I(r);N(d.$$.fragment,W),W.forEach(h),_=T(O),m=y(O,"SPAN",{class:!0});var L=I(m);N(k.$$.fragment,L),L.forEach(h),O.forEach(h),this.h()},h(){w(e,"width",s[3]),w(e,"height",s[4]),w(e,"class","svelte-1poecdg"),n.autoplay=!0,w(n,"width",s[3]),w(n,"height",s[4]),w(n,"class","svelte-1poecdg"),w(f,"class","btn close svelte-1poecdg"),w(r,"class","checked svelte-1poecdg"),w(m,"class","unchecked svelte-1poecdg"),w(i,"class","btn capture svelte-1poecdg"),U(i,"active",s[7]),U(i,"recording",s[8])},m(l,b){v(l,e,b),s[19](e),v(l,t,b),v(l,n,b),s[20](n),v(l,u,b),v(l,f,b),B(a,f,null),v(l,p,b),v(l,i,b),F(i,r),B(d,r,null),F(i,_),F(i,m),B(k,m,null),E=!0,o||(g=[j(f,"click",s[9]),j(i,"mousedown",s[10]),j(i,"touchstart",s[10])],o=!0)},p(l,b){(!E||b&8)&&w(e,"width",l[3]),(!E||b&16)&&w(e,"height",l[4]),(!E||b&8)&&w(n,"width",l[3]),(!E||b&16)&&w(n,"height",l[4]),b&128&&U(i,"active",l[7]),b&256&&U(i,"recording",l[8])},i(l){E||(S(a.$$.fragment,l),S(d.$$.fragment,l),S(k.$$.fragment,l),E=!0)},o(l){V(a.$$.fragment,l),V(d.$$.fragment,l),V(k.$$.fragment,l),E=!1},d(l){l&&h(e),s[19](null),l&&h(t),l&&h(n),s[20](null),l&&h(u),l&&h(f),D(a),l&&h(p),l&&h(i),D(d),D(k),o=!1,Ee(g)}}}function Se(s){let e,t,n,u,f;he(s[18]);function a(i){s[21](i)}let p={$$slots:{default:[Le]},$$scope:{ctx:s}};return s[0]!==void 0&&(p.open=s[0]),e=new Ue({props:p}),z.push(()=>$(e,"open",a)),{c(){R(e.$$.fragment)},l(i){N(e.$$.fragment,i)},m(i,r){B(e,i,r),n=!0,u||(f=j(Y,"resize",s[18]),u=!0)},p(i,[r]){const d={};r&134218142&&(d.$$scope={dirty:r,ctx:i}),!t&&r&1&&(t=!0,d.open=i[0],ee(()=>t=!1)),e.$set(d)},i(i){n||(S(e.$$.fragment,i),n=!0)},o(i){V(e.$$.fragment,i),n=!1},d(i){D(e,i),u=!1,f()}}}function Ve(s,e){return s.getContext("2d").drawImage(e,0,0,s.width,s.height),new Promise(n=>{s.toBlob(n)})}function Oe(s){const e=new MediaRecorder(s),t=[];return e.addEventListener("dataavailable",function(n){n.data.size>0&&t.push(n.data)}),e.start(),()=>new Promise(n=>{e.addEventListener("stop",()=>{n(new Blob(t))}),e.stop()})}function Re(s,e,t){let n,u,f,{open:a=!1}=e,{audio:p=!1}=e,{video:i=!1}=e,{width:r=0}=e,{height:d=0}=e,{mediaStream:_=void 0}=e,{player:m=void 0}=e,{canvas:k=void 0}=e;const E=pe();let o=!1,g=!1,l,b;function O(){t(0,a=!1)}function W(c){c.type==="mousedown"&&c.button!==0||o||(t(7,o=!0),i&&(l=setTimeout(()=>{o&&(t(8,g=!0),t(14,b=Oe(_))),l=void 0},500)))}function L(){o&&(t(7,o=!1),l&&(clearTimeout(l),l=void 0),g?(t(8,g=!1),u()):n())}ge(()=>(window.document.addEventListener("mouseup",L),window.document.addEventListener("mouseleave",L),()=>{window.document.removeEventListener("mouseup",L),window.document.removeEventListener("mouseleave",L)}));let A,H,q=1,P=1;function ie(){t(5,A=Y.innerWidth),t(6,H=Y.innerHeight)}function oe(c){z[c?"unshift":"push"](()=>{k=c,t(2,k)})}function le(c){z[c?"unshift":"push"](()=>{m=c,t(1,m),t(0,a),t(11,_),t(12,p)})}function re(c){a=c,t(0,a)}return s.$$set=c=>{"open"in c&&t(0,a=c.open),"audio"in c&&t(12,p=c.audio),"video"in c&&t(13,i=c.video),"width"in c&&t(3,r=c.width),"height"in c&&t(4,d=c.height),"mediaStream"in c&&t(11,_=c.mediaStream),"player"in c&&t(1,m=c.player),"canvas"in c&&t(2,k=c.canvas)},s.$$.update=()=>{s.$$.dirty&6147&&a&&m&&!_&&typeof navigator.mediaDevices!="undefined"&&navigator.mediaDevices.getUserMedia({video:!0,audio:p}).then(c=>{let J=0,K=0;c.getVideoTracks().forEach(ue=>{const Z=ue.getSettings();J=Math.max(J,Z.width),K=Math.max(K,Z.height)}),t(15,q=J),t(16,P=K),t(11,_=c),t(1,m.srcObject=c,m)}),s.$$.dirty&2049&&!a&&_&&(_.getTracks().forEach(c=>c.stop()),t(11,_=void 0),t(1,m.srcObject=void 0,m)),s.$$.dirty&6&&(n=()=>te().then(()=>Ve(k,m)).then(c=>E("image",c))),s.$$.dirty&16384&&(u=()=>te().then(b).then(c=>E("video",c))),s.$$.dirty&98400&&t(17,f=q>A||P>H?Math.min(A/q,H/P):1),s.$$.dirty&163840&&t(3,r=q*f),s.$$.dirty&196608&&t(4,d=P*f)},[a,m,k,r,d,A,H,o,g,O,W,_,p,i,b,q,P,f,ie,oe,le,re]}class Ne extends Q{constructor(e){super();X(this,e,Re,Se,x,{open:0,audio:12,video:13,width:3,height:4,mediaStream:11,player:1,canvas:2})}}function ne(s){let e,t;return{c(){e=C("img"),this.h()},l(n){e=y(n,"IMG",{src:!0,class:!0}),this.h()},h(){G(e.src,t=s[1])||w(e,"src",t),w(e,"class","svelte-rqyyga")},m(n,u){v(n,e,u)},p(n,u){u&2&&!G(e.src,t=n[1])&&w(e,"src",t)},d(n){n&&h(e)}}}function se(s){let e,t;return{c(){e=C("video"),this.h()},l(n){e=y(n,"VIDEO",{src:!0,class:!0}),I(e).forEach(h),this.h()},h(){G(e.src,t=s[2])||w(e,"src",t),e.controls=!0,w(e,"class","svelte-rqyyga")},m(n,u){v(n,e,u)},p(n,u){u&4&&!G(e.src,t=n[2])&&w(e,"src",t)},d(n){n&&h(e)}}}function Be(s){let e,t,n,u,f,a,p,i,r,d,_=s[1]&&ne(s),m=s[2]&&se(s);function k(o){s[6](o)}let E={audio:!0,video:!0};return s[0]!==void 0&&(E.open=s[0]),a=new Ne({props:E}),z.push(()=>$(a,"open",k)),a.$on("image",s[4]),a.$on("video",s[5]),{c(){e=C("button"),t=Ce("Capture"),n=M(),_&&_.c(),u=M(),m&&m.c(),f=M(),R(a.$$.fragment)},l(o){e=y(o,"BUTTON",{});var g=I(e);t=ye(g,"Capture"),g.forEach(h),n=T(o),_&&_.l(o),u=T(o),m&&m.l(o),f=T(o),N(a.$$.fragment,o)},m(o,g){v(o,e,g),F(e,t),v(o,n,g),_&&_.m(o,g),v(o,u,g),m&&m.m(o,g),v(o,f,g),B(a,o,g),i=!0,r||(d=j(e,"click",s[3]),r=!0)},p(o,[g]){o[1]?_?_.p(o,g):(_=ne(o),_.c(),_.m(u.parentNode,u)):_&&(_.d(1),_=null),o[2]?m?m.p(o,g):(m=se(o),m.c(),m.m(f.parentNode,f)):m&&(m.d(1),m=null);const l={};!p&&g&1&&(p=!0,l.open=o[0],ee(()=>p=!1)),a.$set(l)},i(o){i||(S(a.$$.fragment,o),i=!0)},o(o){V(a.$$.fragment,o),i=!1},d(o){o&&h(e),o&&h(n),_&&_.d(o),o&&h(u),m&&m.d(o),o&&h(f),D(a,o),r=!1,d()}}}function De(s,e,t){let n=!1;function u(){console.log(),t(0,n=!0)}let f;function a(d){t(1,f=URL.createObjectURL(d.detail)),t(0,n=!1)}let p;function i(d){t(2,p=URL.createObjectURL(d.detail)),t(0,n=!1)}function r(d){n=d,t(0,n)}return[n,f,p,u,a,i,r]}class qe extends Q{constructor(e){super();X(this,e,De,Be,x,{})}}export{qe as default};
