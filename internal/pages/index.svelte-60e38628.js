import{S as se,i as ie,N as we,P as ve,w as R,x as B,y as j,q as O,o as V,B as q,F as be,e as C,k as L,c as y,a as S,d as _,m as I,b as w,O as N,g as b,Q as P,J as Ee,K as ke,L as Ce,s as re,R as ye,T as Y,U as ae,V as fe,W as Me,v as Se,X as Le,E as ce,Y as Ie,Z as Te,_ as Ue,$ as De,I as Z,a0 as Oe,a1 as x,t as Ve,h as Ne}from"../chunks/vendor-d4ddf886.js";function Re(s){let e,n,t,r,d,m;const p=s[3].default,i=be(p,s,s[4],null);return{c(){e=C("div"),n=L(),t=C("div"),i&&i.c(),this.h()},l(l){e=y(l,"DIV",{class:!0}),S(e).forEach(_),n=I(l),t=y(l,"DIV",{class:!0});var f=S(t);i&&i.l(f),f.forEach(_),this.h()},h(){w(e,"class","background svelte-1jyu0ly"),N(e,"open",s[0]),w(t,"class","modal svelte-1jyu0ly"),N(t,"open",s[0])},m(l,f){b(l,e,f),b(l,n,f),b(l,t,f),i&&i.m(t,null),r=!0,d||(m=P(e,"click",s[1]),d=!0)},p(l,f){f&1&&N(e,"open",l[0]),i&&i.p&&(!r||f&16)&&Ee(i,p,l,l[4],r?Ce(p,l[4],f,null):ke(l[4]),null),f&1&&N(t,"open",l[0])},i(l){r||(O(i,l),r=!0)},o(l){V(i,l),r=!1},d(l){l&&_(e),l&&_(n),l&&_(t),i&&i.d(l),d=!1,m()}}}function Be(s){let e,n;return e=new ve({props:{$$slots:{default:[Re]},$$scope:{ctx:s}}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){j(e,t,r),n=!0},p(t,[r]){const d={};r&17&&(d.$$scope={dirty:r,ctx:t}),e.$set(d)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function je(s,e,n){let{$$slots:t={},$$scope:r}=e,{open:d=!1}=e,{onClose:m=()=>{}}=e;function p(){n(0,d=!1),m()}return s.$$set=i=>{"open"in i&&n(0,d=i.open),"onClose"in i&&n(2,m=i.onClose),"$$scope"in i&&n(4,r=i.$$scope)},[d,p,m,t,r]}class qe extends se{constructor(e){super();ie(this,e,je,Be,we,{open:0,onClose:2})}}const{window:oe}=Le;function Pe(s){let e,n,t,r,d,m,p,i,l,f,c,h,E,M,u,g,k,W,J;return m=new Ie({}),l=new Te({}),E=new Ue({}),g=new De({}),{c(){e=C("canvas"),n=L(),t=C("video"),r=L(),d=C("button"),R(m.$$.fragment),p=L(),i=C("button"),R(l.$$.fragment),f=L(),c=C("button"),h=C("span"),R(E.$$.fragment),M=L(),u=C("span"),R(g.$$.fragment),this.h()},l(o){e=y(o,"CANVAS",{width:!0,height:!0,class:!0}),S(e).forEach(_),n=I(o),t=y(o,"VIDEO",{width:!0,height:!0,class:!0}),S(t).forEach(_),r=I(o),d=y(o,"BUTTON",{class:!0});var v=S(d);B(m.$$.fragment,v),v.forEach(_),p=I(o),i=y(o,"BUTTON",{class:!0});var K=S(i);B(l.$$.fragment,K),K.forEach(_),f=I(o),c=y(o,"BUTTON",{class:!0});var T=S(c);h=y(T,"SPAN",{class:!0});var Q=S(h);B(E.$$.fragment,Q),Q.forEach(_),M=I(T),u=y(T,"SPAN",{class:!0});var A=S(u);B(g.$$.fragment,A),A.forEach(_),T.forEach(_),this.h()},h(){w(e,"width",s[1]),w(e,"height",s[2]),w(e,"class","svelte-1elb3u5"),t.autoplay=!0,w(t,"width",s[1]),w(t,"height",s[2]),w(t,"class","svelte-1elb3u5"),w(d,"class","btn close svelte-1elb3u5"),w(i,"class","btn switch svelte-1elb3u5"),w(h,"class","checked svelte-1elb3u5"),w(u,"class","unchecked svelte-1elb3u5"),w(c,"class","btn capture svelte-1elb3u5"),N(c,"active",s[7]),N(c,"recording",s[8])},m(o,v){b(o,e,v),s[19](e),b(o,n,v),b(o,t,v),s[20](t),b(o,r,v),b(o,d,v),j(m,d,null),b(o,p,v),b(o,i,v),j(l,i,null),b(o,f,v),b(o,c,v),Z(c,h),j(E,h,null),Z(c,M),Z(c,u),j(g,u,null),k=!0,W||(J=[P(d,"click",s[9]),P(i,"click",s[10]),P(c,"mousedown",s[11]),P(c,"touchstart",s[11])],W=!0)},p(o,v){(!k||v[0]&2)&&w(e,"width",o[1]),(!k||v[0]&4)&&w(e,"height",o[2]),(!k||v[0]&2)&&w(t,"width",o[1]),(!k||v[0]&4)&&w(t,"height",o[2]),v[0]&128&&N(c,"active",o[7]),v[0]&256&&N(c,"recording",o[8])},i(o){k||(O(m.$$.fragment,o),O(l.$$.fragment,o),O(E.$$.fragment,o),O(g.$$.fragment,o),k=!0)},o(o){V(m.$$.fragment,o),V(l.$$.fragment,o),V(E.$$.fragment,o),V(g.$$.fragment,o),k=!1},d(o){o&&_(e),s[19](null),o&&_(n),o&&_(t),s[20](null),o&&_(r),o&&_(d),q(m),o&&_(p),o&&_(i),q(l),o&&_(f),o&&_(c),q(E),q(g),W=!1,Oe(J)}}}function We(s){let e,n,t,r,d;ye(s[18]);function m(i){s[21](i)}let p={$$slots:{default:[Pe]},$$scope:{ctx:s}};return s[0]!==void 0&&(p.open=s[0]),e=new qe({props:p}),Y.push(()=>ae(e,"open",m)),{c(){R(e.$$.fragment)},l(i){B(e.$$.fragment,i)},m(i,l){j(e,i,l),t=!0,r||(d=P(oe,"resize",s[18]),r=!0)},p(i,l){const f={};l[0]&414|l[1]&8&&(f.$$scope={dirty:l,ctx:i}),!n&&l[0]&1&&(n=!0,f.open=i[0],fe(()=>n=!1)),e.$set(f)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){q(e,i),r=!1,d()}}}function Ae(s,e){return s.getContext("2d").drawImage(e,0,0,s.width,s.height),new Promise(t=>{s.toBlob(t)})}function He(s){const e=new MediaRecorder(s),n=[];return e.addEventListener("dataavailable",function(t){t.data.size>0&&n.push(t.data)}),e.start(),()=>new Promise(t=>{e.addEventListener("stop",()=>{t(new Blob(n))}),e.stop()})}function ze(s,e,n){let t,{open:r=!1}=e,{audio:d=!1}=e,{video:m=!1}=e,{width:p=0}=e,{height:i=0}=e,{mediaStream:l=void 0}=e,{player:f=void 0}=e,{canvas:c=void 0}=e;const h=Me();let E=!1,M=!1,u,g;function k(){n(0,r=!1)}function W(){F=F>=X.length-1?0:F+1,$()}function J(a){a.type==="mousedown"&&a.button!==0||E||(n(7,E=!0),m&&(u=setTimeout(()=>{E&&(n(8,M=!0),g=He(l)),u=void 0},500)))}function o(){E&&(n(7,E=!1),u&&(clearTimeout(u),u=void 0),M?(n(8,M=!1),K()):v())}function v(){ce().then(()=>Ae(c,f)).then(a=>h("image",a))}function K(){ce().then(g).then(a=>h("video",a))}Se(()=>(window.document.addEventListener("mouseup",o),window.document.addEventListener("mouseleave",o),window.document.addEventListener("touchend",o),window.document.addEventListener("touchcancel",o),()=>{window.document.removeEventListener("mouseup",o),window.document.removeEventListener("mouseleave",o),window.document.removeEventListener("touchend",o),window.document.removeEventListener("touchcancel",o),T()}));function T(){l&&(l.getTracks().forEach(a=>a.stop()),n(12,l=void 0),n(3,f.srcObject=void 0,f))}function Q(){navigator.mediaDevices.enumerateDevices().then(a=>a.filter(G=>G.kind==="videoinput")).then(a=>{X=a,F>=X.length&&(F=0),$()})}let A=!1;function $(){var a;A||(A=!0,T(),navigator.mediaDevices.getUserMedia({video:{deviceId:(a=X[F])==null?void 0:a.deviceId},audio:d}).then(G=>{let le=!1,ee=0,te=0;G.getVideoTracks().forEach(ne=>{const ue=ne.getSettings();ee=Math.max(ee,ue.width),te=Math.max(te,ue.height),ne.muted&&(le=ne.muted)}),le?(W(),$()):(n(15,U=ee),n(16,D=te),n(12,l=G),n(3,f.srcObject=G,f),n(17,t=U>H||D>z?Math.min(H/U,z/D):1),n(1,p=U*t),n(2,i=D*t))}).finally(()=>{A=!1}))}let H,z,U=1,D=1,X=[],F=0;function _e(){n(5,H=oe.innerWidth),n(6,z=oe.innerHeight)}function he(a){Y[a?"unshift":"push"](()=>{c=a,n(4,c)})}function pe(a){Y[a?"unshift":"push"](()=>{f=a,n(3,f)})}function ge(a){r=a,n(0,r)}return s.$$set=a=>{"open"in a&&n(0,r=a.open),"audio"in a&&n(13,d=a.audio),"video"in a&&n(14,m=a.video),"width"in a&&n(1,p=a.width),"height"in a&&n(2,i=a.height),"mediaStream"in a&&n(12,l=a.mediaStream),"player"in a&&n(3,f=a.player),"canvas"in a&&n(4,c=a.canvas)},s.$$.update=()=>{s.$$.dirty[0]&4097&&r&&!l&&typeof navigator.mediaDevices!="undefined"&&Q(),s.$$.dirty[0]&4097&&!r&&l&&T(),s.$$.dirty[0]&98400&&n(17,t=U>H||D>z?Math.min(H/U,z/D):1),s.$$.dirty[0]&163840&&n(1,p=U*t),s.$$.dirty[0]&196608&&n(2,i=D*t)},[r,p,i,f,c,H,z,E,M,k,W,J,l,d,m,U,D,t,_e,he,pe,ge]}class Fe extends se{constructor(e){super();ie(this,e,ze,We,re,{open:0,audio:13,video:14,width:1,height:2,mediaStream:12,player:3,canvas:4},null,[-1,-1])}}function de(s){let e,n;return{c(){e=C("img"),this.h()},l(t){e=y(t,"IMG",{src:!0,class:!0}),this.h()},h(){x(e.src,n=s[1])||w(e,"src",n),w(e,"class","svelte-rqyyga")},m(t,r){b(t,e,r)},p(t,r){r&2&&!x(e.src,n=t[1])&&w(e,"src",n)},d(t){t&&_(e)}}}function me(s){let e,n;return{c(){e=C("video"),this.h()},l(t){e=y(t,"VIDEO",{src:!0,class:!0}),S(e).forEach(_),this.h()},h(){x(e.src,n=s[2])||w(e,"src",n),e.controls=!0,w(e,"class","svelte-rqyyga")},m(t,r){b(t,e,r)},p(t,r){r&4&&!x(e.src,n=t[2])&&w(e,"src",n)},d(t){t&&_(e)}}}function Ge(s){let e,n,t,r,d,m,p,i,l,f,c=s[1]&&de(s),h=s[2]&&me(s);function E(u){s[6](u)}let M={video:!0};return s[0]!==void 0&&(M.open=s[0]),m=new Fe({props:M}),Y.push(()=>ae(m,"open",E)),m.$on("image",s[4]),m.$on("video",s[5]),{c(){e=C("button"),n=Ve("Capture"),t=L(),c&&c.c(),r=L(),h&&h.c(),d=L(),R(m.$$.fragment)},l(u){e=y(u,"BUTTON",{});var g=S(e);n=Ne(g,"Capture"),g.forEach(_),t=I(u),c&&c.l(u),r=I(u),h&&h.l(u),d=I(u),B(m.$$.fragment,u)},m(u,g){b(u,e,g),Z(e,n),b(u,t,g),c&&c.m(u,g),b(u,r,g),h&&h.m(u,g),b(u,d,g),j(m,u,g),i=!0,l||(f=P(e,"click",s[3]),l=!0)},p(u,[g]){u[1]?c?c.p(u,g):(c=de(u),c.c(),c.m(r.parentNode,r)):c&&(c.d(1),c=null),u[2]?h?h.p(u,g):(h=me(u),h.c(),h.m(d.parentNode,d)):h&&(h.d(1),h=null);const k={};!p&&g&1&&(p=!0,k.open=u[0],fe(()=>p=!1)),m.$set(k)},i(u){i||(O(m.$$.fragment,u),i=!0)},o(u){V(m.$$.fragment,u),i=!1},d(u){u&&_(e),u&&_(t),c&&c.d(u),u&&_(r),h&&h.d(u),u&&_(d),q(m,u),l=!1,f()}}}function Je(s,e,n){let t=!1;function r(){n(0,t=!0)}let d;function m(f){n(1,d=URL.createObjectURL(f.detail)),n(0,t=!1)}let p;function i(f){n(2,p=URL.createObjectURL(f.detail)),n(0,t=!1)}function l(f){t=f,n(0,t)}return[t,d,p,r,m,i,l]}class Qe extends se{constructor(e){super();ie(this,e,Je,Ge,re,{})}}export{Qe as default};
