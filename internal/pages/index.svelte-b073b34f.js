import{S as te,i as ne,N as pe,P as ge,w as R,x as B,y as j,q as D,o as L,B as q,F as be,e as C,k as I,c as y,a as M,d as h,m as T,b,O,g as w,Q as P,J as ve,K as we,L as ke,s as le,R as Ee,T as Y,U as oe,V as ue,W as Ce,v as ye,X as Me,E as re,Y as Se,Z as Ie,_ as Te,$ as Ue,I as Z,a0 as De,a1 as x,t as Le,h as Oe}from"../chunks/vendor-d4ddf886.js";function Ve(s){let e,n,t,r,d,f;const g=s[3].default,i=be(g,s,s[4],null);return{c(){e=C("div"),n=I(),t=C("div"),i&&i.c(),this.h()},l(o){e=y(o,"DIV",{class:!0}),M(e).forEach(h),n=T(o),t=y(o,"DIV",{class:!0});var m=M(t);i&&i.l(m),m.forEach(h),this.h()},h(){b(e,"class","background svelte-1jyu0ly"),O(e,"open",s[0]),b(t,"class","modal svelte-1jyu0ly"),O(t,"open",s[0])},m(o,m){w(o,e,m),w(o,n,m),w(o,t,m),i&&i.m(t,null),r=!0,d||(f=P(e,"click",s[1]),d=!0)},p(o,m){m&1&&O(e,"open",o[0]),i&&i.p&&(!r||m&16)&&ve(i,g,o,o[4],r?ke(g,o[4],m,null):we(o[4]),null),m&1&&O(t,"open",o[0])},i(o){r||(D(i,o),r=!0)},o(o){L(i,o),r=!1},d(o){o&&h(e),o&&h(n),o&&h(t),i&&i.d(o),d=!1,f()}}}function Ne(s){let e,n;return e=new ge({props:{$$slots:{default:[Ve]},$$scope:{ctx:s}}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,r){j(e,t,r),n=!0},p(t,[r]){const d={};r&17&&(d.$$scope={dirty:r,ctx:t}),e.$set(d)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){L(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function Re(s,e,n){let{$$slots:t={},$$scope:r}=e,{open:d=!1}=e,{onClose:f=()=>{}}=e;function g(){n(0,d=!1),f()}return s.$$set=i=>{"open"in i&&n(0,d=i.open),"onClose"in i&&n(2,f=i.onClose),"$$scope"in i&&n(4,r=i.$$scope)},[d,g,f,t,r]}class Be extends te{constructor(e){super();ne(this,e,Re,Ne,pe,{open:0,onClose:2})}}const{window:se}=Me;function je(s){let e,n,t,r,d,f,g,i,o,m,a,_,E,S,l,p,k,V,G;return f=new Se({}),o=new Ie({}),E=new Te({}),p=new Ue({}),{c(){e=C("canvas"),n=I(),t=C("video"),r=I(),d=C("button"),R(f.$$.fragment),g=I(),i=C("button"),R(o.$$.fragment),m=I(),a=C("button"),_=C("span"),R(E.$$.fragment),S=I(),l=C("span"),R(p.$$.fragment),this.h()},l(u){e=y(u,"CANVAS",{width:!0,height:!0,class:!0}),M(e).forEach(h),n=T(u),t=y(u,"VIDEO",{width:!0,height:!0,class:!0}),M(t).forEach(h),r=T(u),d=y(u,"BUTTON",{class:!0});var v=M(d);B(f.$$.fragment,v),v.forEach(h),g=T(u),i=y(u,"BUTTON",{class:!0});var N=M(i);B(o.$$.fragment,N),N.forEach(h),m=T(u),a=y(u,"BUTTON",{class:!0});var U=M(a);_=y(U,"SPAN",{class:!0});var J=M(_);B(E.$$.fragment,J),J.forEach(h),S=T(U),l=y(U,"SPAN",{class:!0});var A=M(l);B(p.$$.fragment,A),A.forEach(h),U.forEach(h),this.h()},h(){b(e,"width",s[3]),b(e,"height",s[4]),b(e,"class","svelte-1elb3u5"),t.autoplay=!0,b(t,"width",s[3]),b(t,"height",s[4]),b(t,"class","svelte-1elb3u5"),b(d,"class","btn close svelte-1elb3u5"),b(i,"class","btn switch svelte-1elb3u5"),b(_,"class","checked svelte-1elb3u5"),b(l,"class","unchecked svelte-1elb3u5"),b(a,"class","btn capture svelte-1elb3u5"),O(a,"active",s[7]),O(a,"recording",s[8])},m(u,v){w(u,e,v),s[20](e),w(u,n,v),w(u,t,v),s[21](t),w(u,r,v),w(u,d,v),j(f,d,null),w(u,g,v),w(u,i,v),j(o,i,null),w(u,m,v),w(u,a,v),Z(a,_),j(E,_,null),Z(a,S),Z(a,l),j(p,l,null),k=!0,V||(G=[P(d,"click",s[9]),P(i,"click",s[10]),P(a,"mousedown",s[11]),P(a,"touchstart",s[11])],V=!0)},p(u,v){(!k||v[0]&8)&&b(e,"width",u[3]),(!k||v[0]&16)&&b(e,"height",u[4]),(!k||v[0]&8)&&b(t,"width",u[3]),(!k||v[0]&16)&&b(t,"height",u[4]),v[0]&128&&O(a,"active",u[7]),v[0]&256&&O(a,"recording",u[8])},i(u){k||(D(f.$$.fragment,u),D(o.$$.fragment,u),D(E.$$.fragment,u),D(p.$$.fragment,u),k=!0)},o(u){L(f.$$.fragment,u),L(o.$$.fragment,u),L(E.$$.fragment,u),L(p.$$.fragment,u),k=!1},d(u){u&&h(e),s[20](null),u&&h(n),u&&h(t),s[21](null),u&&h(r),u&&h(d),q(f),u&&h(g),u&&h(i),q(o),u&&h(m),u&&h(a),q(E),q(p),V=!1,De(G)}}}function qe(s){let e,n,t,r,d;Ee(s[19]);function f(i){s[22](i)}let g={$$slots:{default:[je]},$$scope:{ctx:s}};return s[0]!==void 0&&(g.open=s[0]),e=new Be({props:g}),Y.push(()=>oe(e,"open",f)),{c(){R(e.$$.fragment)},l(i){B(e.$$.fragment,i)},m(i,o){j(e,i,o),t=!0,r||(d=P(se,"resize",s[19]),r=!0)},p(i,o){const m={};o[0]&414|o[1]&4&&(m.$$scope={dirty:o,ctx:i}),!n&&o[0]&1&&(n=!0,m.open=i[0],ue(()=>n=!1)),e.$set(m)},i(i){t||(D(e.$$.fragment,i),t=!0)},o(i){L(e.$$.fragment,i),t=!1},d(i){q(e,i),r=!1,d()}}}function Pe(s,e){return s.getContext("2d").drawImage(e,0,0,s.width,s.height),new Promise(t=>{s.toBlob(t)})}function We(s){const e=new MediaRecorder(s),n=[];return e.addEventListener("dataavailable",function(t){t.data.size>0&&n.push(t.data)}),e.start(),()=>new Promise(t=>{e.addEventListener("stop",()=>{t(new Blob(n))}),e.stop()})}function Ae(s,e,n){let t,r,d,{open:f=!1}=e,{audio:g=!1}=e,{video:i=!1}=e,{width:o=0}=e,{height:m=0}=e,{mediaStream:a=void 0}=e,{player:_=void 0}=e,{canvas:E=void 0}=e;const S=Ce();let l=!1,p=!1,k,V;function G(){n(0,f=!1)}function u(){W=W>=X.length-1?0:W+1,A()}function v(c){c.type==="mousedown"&&c.button!==0||l||(n(7,l=!0),i&&(k=setTimeout(()=>{l&&(n(8,p=!0),n(15,V=We(a))),k=void 0},500)))}function N(){l&&(n(7,l=!1),k&&(clearTimeout(k),k=void 0),p?(n(8,p=!1),r()):t())}ye(()=>(window.document.addEventListener("mouseup",N),window.document.addEventListener("mouseleave",N),()=>{window.document.removeEventListener("mouseup",N),window.document.removeEventListener("mouseleave",N),U()}));function U(){a&&(a.getTracks().forEach(c=>c.stop()),n(12,a=void 0),n(1,_.srcObject=void 0,_))}function J(){navigator.mediaDevices.enumerateDevices().then(c=>{X=c.filter(F=>F.kind==="videoinput"),W>=X.length&&(W=0),A()})}function A(){var c;U(),navigator.mediaDevices.getUserMedia({video:{deviceId:(c=X[W])==null?void 0:c.deviceId},audio:g}).then(F=>{let $=0,ee=0;F.getVideoTracks().forEach(he=>{const ie=he.getSettings();$=Math.max($,ie.width),ee=Math.max(ee,ie.height)}),n(16,H=$),n(17,z=ee),n(12,a=F),n(1,_.srcObject=F,_)})}let K,Q,H=1,z=1,X=[],W=0;function ce(){n(5,K=se.innerWidth),n(6,Q=se.innerHeight)}function de(c){Y[c?"unshift":"push"](()=>{E=c,n(2,E)})}function me(c){Y[c?"unshift":"push"](()=>{_=c,n(1,_)})}function _e(c){f=c,n(0,f)}return s.$$set=c=>{"open"in c&&n(0,f=c.open),"audio"in c&&n(13,g=c.audio),"video"in c&&n(14,i=c.video),"width"in c&&n(3,o=c.width),"height"in c&&n(4,m=c.height),"mediaStream"in c&&n(12,a=c.mediaStream),"player"in c&&n(1,_=c.player),"canvas"in c&&n(2,E=c.canvas)},s.$$.update=()=>{s.$$.dirty[0]&6&&(t=()=>re().then(()=>Pe(E,_)).then(c=>S("image",c))),s.$$.dirty[0]&32768&&(r=()=>re().then(V).then(c=>S("video",c))),s.$$.dirty[0]&4097&&f&&!a&&typeof navigator.mediaDevices!="undefined"&&J(),s.$$.dirty[0]&4097&&!f&&a&&U(),s.$$.dirty[0]&196704&&n(18,d=H>K||z>Q?Math.min(K/H,Q/z):1),s.$$.dirty[0]&327680&&n(3,o=H*d),s.$$.dirty[0]&393216&&n(4,m=z*d)},[f,_,E,o,m,K,Q,l,p,G,u,v,a,g,i,V,H,z,d,ce,de,me,_e]}class He extends te{constructor(e){super();ne(this,e,Ae,qe,le,{open:0,audio:13,video:14,width:3,height:4,mediaStream:12,player:1,canvas:2},null,[-1,-1])}}function ae(s){let e,n;return{c(){e=C("img"),this.h()},l(t){e=y(t,"IMG",{src:!0,class:!0}),this.h()},h(){x(e.src,n=s[1])||b(e,"src",n),b(e,"class","svelte-rqyyga")},m(t,r){w(t,e,r)},p(t,r){r&2&&!x(e.src,n=t[1])&&b(e,"src",n)},d(t){t&&h(e)}}}function fe(s){let e,n;return{c(){e=C("video"),this.h()},l(t){e=y(t,"VIDEO",{src:!0,class:!0}),M(e).forEach(h),this.h()},h(){x(e.src,n=s[2])||b(e,"src",n),e.controls=!0,b(e,"class","svelte-rqyyga")},m(t,r){w(t,e,r)},p(t,r){r&4&&!x(e.src,n=t[2])&&b(e,"src",n)},d(t){t&&h(e)}}}function ze(s){let e,n,t,r,d,f,g,i,o,m,a=s[1]&&ae(s),_=s[2]&&fe(s);function E(l){s[6](l)}let S={video:!0};return s[0]!==void 0&&(S.open=s[0]),f=new He({props:S}),Y.push(()=>oe(f,"open",E)),f.$on("image",s[4]),f.$on("video",s[5]),{c(){e=C("button"),n=Le("Capture"),t=I(),a&&a.c(),r=I(),_&&_.c(),d=I(),R(f.$$.fragment)},l(l){e=y(l,"BUTTON",{});var p=M(e);n=Oe(p,"Capture"),p.forEach(h),t=T(l),a&&a.l(l),r=T(l),_&&_.l(l),d=T(l),B(f.$$.fragment,l)},m(l,p){w(l,e,p),Z(e,n),w(l,t,p),a&&a.m(l,p),w(l,r,p),_&&_.m(l,p),w(l,d,p),j(f,l,p),i=!0,o||(m=P(e,"click",s[3]),o=!0)},p(l,[p]){l[1]?a?a.p(l,p):(a=ae(l),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null),l[2]?_?_.p(l,p):(_=fe(l),_.c(),_.m(d.parentNode,d)):_&&(_.d(1),_=null);const k={};!g&&p&1&&(g=!0,k.open=l[0],ue(()=>g=!1)),f.$set(k)},i(l){i||(D(f.$$.fragment,l),i=!0)},o(l){L(f.$$.fragment,l),i=!1},d(l){l&&h(e),l&&h(t),a&&a.d(l),l&&h(r),_&&_.d(l),l&&h(d),q(f,l),o=!1,m()}}}function Fe(s,e,n){let t=!1;function r(){console.log(),n(0,t=!0)}let d;function f(m){n(1,d=URL.createObjectURL(m.detail)),n(0,t=!1)}let g;function i(m){n(2,g=URL.createObjectURL(m.detail)),n(0,t=!1)}function o(m){t=m,n(0,t)}return[t,d,g,r,f,i,o]}class Je extends te{constructor(e){super();ne(this,e,Fe,ze,le,{})}}export{Je as default};
