import{S as ie,i as se,N as Ee,P as Ce,w as H,x as F,y as G,q as P,o as j,B as J,F as Le,e as M,k as B,c as I,a as N,d as p,m as O,b as g,O as q,g as U,Q as W,J as Ue,K as Me,L as Ie,s as fe,R as Se,T as Z,U as ce,V as de,W as Te,v as Ve,X as De,E as me,Y as Ne,M as ye,Z as Be,_ as Oe,I as V,n as Re,p as Ae,$ as he,a0 as Pe,a1 as x,t as le,h as oe}from"../chunks/vendor-df462d62.js";function je(i){let e,t,n,u,f,m;const d=i[3].default,o=Le(d,i,i[4],null);return{c(){e=M("div"),t=B(),n=M("div"),o&&o.c(),this.h()},l(s){e=I(s,"DIV",{class:!0}),N(e).forEach(p),t=O(s),n=I(s,"DIV",{class:!0});var r=N(n);o&&o.l(r),r.forEach(p),this.h()},h(){g(e,"class","background svelte-1jyu0ly"),q(e,"open",i[0]),g(n,"class","modal svelte-1jyu0ly"),q(n,"open",i[0])},m(s,r){U(s,e,r),U(s,t,r),U(s,n,r),o&&o.m(n,null),u=!0,f||(m=W(e,"click",i[1]),f=!0)},p(s,r){r&1&&q(e,"open",s[0]),o&&o.p&&(!u||r&16)&&Ue(o,d,s,s[4],u?Ie(d,s[4],r,null):Me(s[4]),null),r&1&&q(n,"open",s[0])},i(s){u||(P(o,s),u=!0)},o(s){j(o,s),u=!1},d(s){s&&p(e),s&&p(t),s&&p(n),o&&o.d(s),f=!1,m()}}}function ze(i){let e,t;return e=new Ce({props:{$$slots:{default:[je]},$$scope:{ctx:i}}}),{c(){H(e.$$.fragment)},l(n){F(e.$$.fragment,n)},m(n,u){G(e,n,u),t=!0},p(n,[u]){const f={};u&17&&(f.$$scope={dirty:u,ctx:n}),e.$set(f)},i(n){t||(P(e.$$.fragment,n),t=!0)},o(n){j(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function We(i,e,t){let{$$slots:n={},$$scope:u}=e,{open:f=!1}=e,{onClose:m=()=>{}}=e;function d(){t(0,f=!1),m()}return i.$$set=o=>{"open"in o&&t(0,f=o.open),"onClose"in o&&t(2,m=o.onClose),"$$scope"in o&&t(4,u=o.$$scope)},[f,d,m,n,u]}class qe extends ie{constructor(e){super();se(this,e,We,ze,Ee,{open:0,onClose:2})}}const{window:ue}=De;function _e(i){let e,t,n,u,f;return t=new Pe({}),{c(){e=M("button"),H(t.$$.fragment),this.h()},l(m){e=I(m,"BUTTON",{class:!0});var d=N(e);F(t.$$.fragment,d),d.forEach(p),this.h()},h(){g(e,"class","btn switch svelte-1elb3u5")},m(m,d){U(m,e,d),G(t,e,null),n=!0,u||(f=W(e,"click",i[11]),u=!0)},p:ye,i(m){n||(P(t.$$.fragment,m),n=!0)},o(m){j(t.$$.fragment,m),n=!1},d(m){m&&p(e),J(t),u=!1,f()}}}function He(i){let e,t,n,u,f,m,d,o,s,r,C,T,L,b,k,y,S;m=new Ne({});let v=i[9].length>1&&_e(i);return C=new Be({}),b=new Oe({}),{c(){e=M("canvas"),t=B(),n=M("video"),u=B(),f=M("button"),H(m.$$.fragment),d=B(),v&&v.c(),o=B(),s=M("button"),r=M("span"),H(C.$$.fragment),T=B(),L=M("span"),H(b.$$.fragment),this.h()},l(l){e=I(l,"CANVAS",{width:!0,height:!0,class:!0}),N(e).forEach(p),t=O(l),n=I(l,"VIDEO",{width:!0,height:!0,class:!0}),N(n).forEach(p),u=O(l),f=I(l,"BUTTON",{class:!0});var h=N(f);F(m.$$.fragment,h),h.forEach(p),d=O(l),v&&v.l(l),o=O(l),s=I(l,"BUTTON",{class:!0});var z=N(s);r=I(z,"SPAN",{class:!0});var E=N(r);F(C.$$.fragment,E),E.forEach(p),T=O(z),L=I(z,"SPAN",{class:!0});var w=N(L);F(b.$$.fragment,w),w.forEach(p),z.forEach(p),this.h()},h(){g(e,"width",i[1]),g(e,"height",i[2]),g(e,"class","svelte-1elb3u5"),n.autoplay=!0,g(n,"width",i[1]),g(n,"height",i[2]),g(n,"class","svelte-1elb3u5"),g(f,"class","btn close svelte-1elb3u5"),g(r,"class","checked svelte-1elb3u5"),g(L,"class","unchecked svelte-1elb3u5"),g(s,"class","btn capture svelte-1elb3u5"),q(s,"active",i[7]),q(s,"recording",i[8])},m(l,h){U(l,e,h),i[20](e),U(l,t,h),U(l,n,h),i[21](n),U(l,u,h),U(l,f,h),G(m,f,null),U(l,d,h),v&&v.m(l,h),U(l,o,h),U(l,s,h),V(s,r),G(C,r,null),V(s,T),V(s,L),G(b,L,null),k=!0,y||(S=[W(f,"click",i[10]),W(s,"mousedown",i[12]),W(s,"touchstart",i[12])],y=!0)},p(l,h){(!k||h[0]&2)&&g(e,"width",l[1]),(!k||h[0]&4)&&g(e,"height",l[2]),(!k||h[0]&2)&&g(n,"width",l[1]),(!k||h[0]&4)&&g(n,"height",l[2]),l[9].length>1?v?(v.p(l,h),h[0]&512&&P(v,1)):(v=_e(l),v.c(),P(v,1),v.m(o.parentNode,o)):v&&(Re(),j(v,1,1,()=>{v=null}),Ae()),h[0]&128&&q(s,"active",l[7]),h[0]&256&&q(s,"recording",l[8])},i(l){k||(P(m.$$.fragment,l),P(v),P(C.$$.fragment,l),P(b.$$.fragment,l),k=!0)},o(l){j(m.$$.fragment,l),j(v),j(C.$$.fragment,l),j(b.$$.fragment,l),k=!1},d(l){l&&p(e),i[20](null),l&&p(t),l&&p(n),i[21](null),l&&p(u),l&&p(f),J(m),l&&p(d),v&&v.d(l),l&&p(o),l&&p(s),J(C),J(b),y=!1,he(S)}}}function Fe(i){let e,t,n,u,f;Se(i[19]);function m(o){i[22](o)}let d={$$slots:{default:[He]},$$scope:{ctx:i}};return i[0]!==void 0&&(d.open=i[0]),e=new qe({props:d}),Z.push(()=>ce(e,"open",m)),{c(){H(e.$$.fragment)},l(o){F(e.$$.fragment,o)},m(o,s){G(e,o,s),n=!0,u||(f=W(ue,"resize",i[19]),u=!0)},p(o,s){const r={};s[0]&926|s[1]&8&&(r.$$scope={dirty:s,ctx:o}),!t&&s[0]&1&&(t=!0,r.open=o[0],de(()=>t=!1)),e.$set(r)},i(o){n||(P(e.$$.fragment,o),n=!0)},o(o){j(e.$$.fragment,o),n=!1},d(o){J(e,o),u=!1,f()}}}function Ge(i,e){return i.getContext("2d").drawImage(e,0,0,i.width,i.height),new Promise(n=>{i.toBlob(n)})}function Je(i){const e=new MediaRecorder(i),t=[];return e.addEventListener("dataavailable",function(n){n.data.size>0&&t.push(n.data)}),e.start(),()=>new Promise(n=>{e.addEventListener("stop",()=>{n(new Blob(t))}),e.stop()})}function Ke(i,e,t){let n,{open:u=!1}=e,{audio:f=!1}=e,{video:m=!1}=e,{width:d=0}=e,{height:o=0}=e,{mediaStream:s=void 0}=e,{player:r=void 0}=e,{canvas:C=void 0}=e;const T=Te();let L=!1,b=!1,k,y;function S(){t(0,u=!1)}function v(){Q=Q>=X.length-1?0:Q+1,a()}function l(c){c.type==="mousedown"&&c.button!==0||L||(t(7,L=!0),m&&(k=setTimeout(()=>{L&&(t(8,b=!0),y=Je(s)),k=void 0},500)))}function h(){L&&(t(7,L=!1),k&&(clearTimeout(k),k=void 0),b?(t(8,b=!1),E()):z())}function z(){me().then(()=>Ge(C,r)).then(c=>T("image",c))}function E(){me().then(y).then(c=>T("video",c))}Ve(()=>(window.document.addEventListener("mouseup",h),window.document.addEventListener("mouseleave",h),window.document.addEventListener("touchend",h),window.document.addEventListener("touchcancel",h),()=>{window.document.removeEventListener("mouseup",h),window.document.removeEventListener("mouseleave",h),window.document.removeEventListener("touchend",h),window.document.removeEventListener("touchcancel",h),w()}));function w(){s&&(s.getTracks().forEach(c=>c.stop()),t(13,s=void 0),t(3,r.srcObject=void 0,r))}function $(){navigator.mediaDevices.enumerateDevices().then(c=>c.filter(Y=>Y.kind==="videoinput")).then(c=>{t(9,X=c),Q>=X.length&&(Q=0),a()})}let K=!1;function a(){var c;K||(K=!0,w(),navigator.mediaDevices.getUserMedia({video:{deviceId:(c=X[Q])==null?void 0:c.deviceId},audio:f}).then(Y=>{let ae=!1,ee=0,te=0;Y.getVideoTracks().forEach(ne=>{const re=ne.getSettings();ee=Math.max(ee,re.width),te=Math.max(te,re.height),ne.muted&&(ae=ne.muted)}),ae?(v(),a()):(t(16,R=ee),t(17,A=te),t(13,s=Y),t(3,r.srcObject=Y,r),t(18,n=R>_||A>D?Math.min(_/R,D/A):1),t(1,d=R*n),t(2,o=A*n))}).finally(()=>{K=!1}))}let _,D,R=1,A=1,X=[],Q=0;function be(){t(5,_=ue.innerWidth),t(6,D=ue.innerHeight)}function ve(c){Z[c?"unshift":"push"](()=>{C=c,t(4,C)})}function we(c){Z[c?"unshift":"push"](()=>{r=c,t(3,r)})}function ke(c){u=c,t(0,u)}return i.$$set=c=>{"open"in c&&t(0,u=c.open),"audio"in c&&t(14,f=c.audio),"video"in c&&t(15,m=c.video),"width"in c&&t(1,d=c.width),"height"in c&&t(2,o=c.height),"mediaStream"in c&&t(13,s=c.mediaStream),"player"in c&&t(3,r=c.player),"canvas"in c&&t(4,C=c.canvas)},i.$$.update=()=>{i.$$.dirty[0]&8193&&u&&!s&&typeof navigator.mediaDevices!="undefined"&&$(),i.$$.dirty[0]&8193&&!u&&s&&w(),i.$$.dirty[0]&196704&&t(18,n=R>_||A>D?Math.min(_/R,D/A):1),i.$$.dirty[0]&327680&&t(1,d=R*n),i.$$.dirty[0]&393216&&t(2,o=A*n)},[u,d,o,r,C,_,D,L,b,X,S,v,l,s,f,m,R,A,n,be,ve,we,ke]}class Qe extends ie{constructor(e){super();se(this,e,Ke,Fe,fe,{open:0,audio:14,video:15,width:1,height:2,mediaStream:13,player:3,canvas:4},null,[-1,-1])}}function pe(i){let e,t;return{c(){e=M("img"),this.h()},l(n){e=I(n,"IMG",{src:!0,class:!0}),this.h()},h(){x(e.src,t=i[3])||g(e,"src",t),g(e,"class","svelte-lzgac9")},m(n,u){U(n,e,u)},p(n,u){u&8&&!x(e.src,t=n[3])&&g(e,"src",t)},d(n){n&&p(e)}}}function ge(i){let e,t;return{c(){e=M("video"),this.h()},l(n){e=I(n,"VIDEO",{src:!0,class:!0}),N(e).forEach(p),this.h()},h(){x(e.src,t=i[4])||g(e,"src",t),e.controls=!0,g(e,"class","svelte-lzgac9")},m(n,u){U(n,e,u)},p(n,u){u&16&&!x(e.src,t=n[4])&&g(e,"src",t)},d(n){n&&p(e)}}}function Xe(i){let e,t,n,u,f,m,d,o,s,r,C,T,L,b,k,y,S,v,l,h,z,E=i[3]&&pe(i),w=i[4]&&ge(i);function $(a){i[10](a)}let K={video:i[0],audio:i[1]};return i[2]!==void 0&&(K.open=i[2]),S=new Qe({props:K}),Z.push(()=>ce(S,"open",$)),S.$on("image",i[8]),S.$on("video",i[9]),{c(){e=M("div"),t=M("label"),n=le("Use Video"),u=B(),f=M("input"),m=B(),d=M("label"),o=le("Use Audio"),s=B(),r=M("input"),C=B(),T=M("button"),L=le("Capture"),b=B(),E&&E.c(),k=B(),w&&w.c(),y=B(),H(S.$$.fragment),this.h()},l(a){e=I(a,"DIV",{class:!0});var _=N(e);t=I(_,"LABEL",{for:!0});var D=N(t);n=oe(D,"Use Video"),D.forEach(p),u=O(_),f=I(_,"INPUT",{id:!0,type:!0}),m=O(_),d=I(_,"LABEL",{for:!0});var R=N(d);o=oe(R,"Use Audio"),R.forEach(p),s=O(_),r=I(_,"INPUT",{id:!0,type:!0}),C=O(_),T=I(_,"BUTTON",{});var A=N(T);L=oe(A,"Capture"),A.forEach(p),_.forEach(p),b=O(a),E&&E.l(a),k=O(a),w&&w.l(a),y=O(a),F(S.$$.fragment,a),this.h()},h(){g(t,"for","video"),g(f,"id","video"),g(f,"type","checkbox"),f.checked=i[0],g(d,"for","audio"),g(r,"id","audio"),g(r,"type","checkbox"),r.checked=i[1],g(e,"class","controls svelte-lzgac9")},m(a,_){U(a,e,_),V(e,t),V(t,n),V(e,u),V(e,f),V(e,m),V(e,d),V(d,o),V(e,s),V(e,r),V(e,C),V(e,T),V(T,L),U(a,b,_),E&&E.m(a,_),U(a,k,_),w&&w.m(a,_),U(a,y,_),G(S,a,_),l=!0,h||(z=[W(f,"change",i[5]),W(r,"change",i[6]),W(T,"click",i[7])],h=!0)},p(a,[_]){(!l||_&1)&&(f.checked=a[0]),(!l||_&2)&&(r.checked=a[1]),a[3]?E?E.p(a,_):(E=pe(a),E.c(),E.m(k.parentNode,k)):E&&(E.d(1),E=null),a[4]?w?w.p(a,_):(w=ge(a),w.c(),w.m(y.parentNode,y)):w&&(w.d(1),w=null);const D={};_&1&&(D.video=a[0]),_&2&&(D.audio=a[1]),!v&&_&4&&(v=!0,D.open=a[2],de(()=>v=!1)),S.$set(D)},i(a){l||(P(S.$$.fragment,a),l=!0)},o(a){j(S.$$.fragment,a),l=!1},d(a){a&&p(e),a&&p(b),E&&E.d(a),a&&p(k),w&&w.d(a),a&&p(y),J(S,a),h=!1,he(z)}}}function Ye(i,e,t){let n=!0;function u(b){t(0,n=b.target.checked)}let f=!1;function m(b){t(1,f=b.target.checked)}let d=!1;function o(){t(2,d=!0)}let s;function r(b){t(3,s=URL.createObjectURL(b.detail)),t(2,d=!1)}let C;function T(b){t(4,C=URL.createObjectURL(b.detail)),t(2,d=!1)}function L(b){d=b,t(2,d)}return[n,f,d,s,C,u,m,o,r,T,L]}class xe extends ie{constructor(e){super();se(this,e,Ye,Xe,fe,{})}}export{xe as default};
