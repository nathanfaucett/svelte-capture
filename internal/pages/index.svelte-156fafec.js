import{S as se,i as ie,N as be,P as ve,w as R,x as B,y as j,q as O,o as V,B as q,F as we,e as C,k as I,c as y,a as S,d as _,m as T,b,O as N,g as w,Q as P,J as ke,K as Ee,L as Ce,s as fe,R as ye,T as Y,U as re,V as ae,W as Me,v as Se,X as Ie,E as ce,Y as Te,Z as Ue,_ as De,$ as Le,I as Z,a0 as Oe,a1 as x,t as Ve,h as Ne}from"../chunks/vendor-d4ddf886.js";function Re(s){let e,n,t,f,d,m;const p=s[3].default,i=we(p,s,s[4],null);return{c(){e=C("div"),n=I(),t=C("div"),i&&i.c(),this.h()},l(l){e=y(l,"DIV",{class:!0}),S(e).forEach(_),n=T(l),t=y(l,"DIV",{class:!0});var a=S(t);i&&i.l(a),a.forEach(_),this.h()},h(){b(e,"class","background svelte-1jyu0ly"),N(e,"open",s[0]),b(t,"class","modal svelte-1jyu0ly"),N(t,"open",s[0])},m(l,a){w(l,e,a),w(l,n,a),w(l,t,a),i&&i.m(t,null),f=!0,d||(m=P(e,"click",s[1]),d=!0)},p(l,a){a&1&&N(e,"open",l[0]),i&&i.p&&(!f||a&16)&&ke(i,p,l,l[4],f?Ce(p,l[4],a,null):Ee(l[4]),null),a&1&&N(t,"open",l[0])},i(l){f||(O(i,l),f=!0)},o(l){V(i,l),f=!1},d(l){l&&_(e),l&&_(n),l&&_(t),i&&i.d(l),d=!1,m()}}}function Be(s){let e,n;return e=new ve({props:{$$slots:{default:[Re]},$$scope:{ctx:s}}}),{c(){R(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,f){j(e,t,f),n=!0},p(t,[f]){const d={};f&17&&(d.$$scope={dirty:f,ctx:t}),e.$set(d)},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){V(e.$$.fragment,t),n=!1},d(t){q(e,t)}}}function je(s,e,n){let{$$slots:t={},$$scope:f}=e,{open:d=!1}=e,{onClose:m=()=>{}}=e;function p(){n(0,d=!1),m()}return s.$$set=i=>{"open"in i&&n(0,d=i.open),"onClose"in i&&n(2,m=i.onClose),"$$scope"in i&&n(4,f=i.$$scope)},[d,p,m,t,f]}class qe extends se{constructor(e){super();ie(this,e,je,Be,be,{open:0,onClose:2})}}const{window:le}=Ie;function Pe(s){let e,n,t,f,d,m,p,i,l,a,c,h,k,M,u,g,E,W,J;return m=new Te({}),l=new Ue({}),k=new De({}),g=new Le({}),{c(){e=C("canvas"),n=I(),t=C("video"),f=I(),d=C("button"),R(m.$$.fragment),p=I(),i=C("button"),R(l.$$.fragment),a=I(),c=C("button"),h=C("span"),R(k.$$.fragment),M=I(),u=C("span"),R(g.$$.fragment),this.h()},l(o){e=y(o,"CANVAS",{width:!0,height:!0,class:!0}),S(e).forEach(_),n=T(o),t=y(o,"VIDEO",{width:!0,height:!0,class:!0}),S(t).forEach(_),f=T(o),d=y(o,"BUTTON",{class:!0});var v=S(d);B(m.$$.fragment,v),v.forEach(_),p=T(o),i=y(o,"BUTTON",{class:!0});var K=S(i);B(l.$$.fragment,K),K.forEach(_),a=T(o),c=y(o,"BUTTON",{class:!0});var U=S(c);h=y(U,"SPAN",{class:!0});var Q=S(h);B(k.$$.fragment,Q),Q.forEach(_),M=T(U),u=y(U,"SPAN",{class:!0});var A=S(u);B(g.$$.fragment,A),A.forEach(_),U.forEach(_),this.h()},h(){b(e,"width",s[1]),b(e,"height",s[2]),b(e,"class","svelte-1elb3u5"),t.autoplay=!0,b(t,"width",s[1]),b(t,"height",s[2]),b(t,"class","svelte-1elb3u5"),b(d,"class","btn close svelte-1elb3u5"),b(i,"class","btn switch svelte-1elb3u5"),b(h,"class","checked svelte-1elb3u5"),b(u,"class","unchecked svelte-1elb3u5"),b(c,"class","btn capture svelte-1elb3u5"),N(c,"active",s[7]),N(c,"recording",s[8])},m(o,v){w(o,e,v),s[19](e),w(o,n,v),w(o,t,v),s[20](t),w(o,f,v),w(o,d,v),j(m,d,null),w(o,p,v),w(o,i,v),j(l,i,null),w(o,a,v),w(o,c,v),Z(c,h),j(k,h,null),Z(c,M),Z(c,u),j(g,u,null),E=!0,W||(J=[P(d,"click",s[9]),P(i,"click",s[10]),P(c,"mousedown",s[11]),P(c,"touchstart",s[11])],W=!0)},p(o,v){(!E||v[0]&2)&&b(e,"width",o[1]),(!E||v[0]&4)&&b(e,"height",o[2]),(!E||v[0]&2)&&b(t,"width",o[1]),(!E||v[0]&4)&&b(t,"height",o[2]),v[0]&128&&N(c,"active",o[7]),v[0]&256&&N(c,"recording",o[8])},i(o){E||(O(m.$$.fragment,o),O(l.$$.fragment,o),O(k.$$.fragment,o),O(g.$$.fragment,o),E=!0)},o(o){V(m.$$.fragment,o),V(l.$$.fragment,o),V(k.$$.fragment,o),V(g.$$.fragment,o),E=!1},d(o){o&&_(e),s[19](null),o&&_(n),o&&_(t),s[20](null),o&&_(f),o&&_(d),q(m),o&&_(p),o&&_(i),q(l),o&&_(a),o&&_(c),q(k),q(g),W=!1,Oe(J)}}}function We(s){let e,n,t,f,d;ye(s[18]);function m(i){s[21](i)}let p={$$slots:{default:[Pe]},$$scope:{ctx:s}};return s[0]!==void 0&&(p.open=s[0]),e=new qe({props:p}),Y.push(()=>re(e,"open",m)),{c(){R(e.$$.fragment)},l(i){B(e.$$.fragment,i)},m(i,l){j(e,i,l),t=!0,f||(d=P(le,"resize",s[18]),f=!0)},p(i,l){const a={};l[0]&414|l[1]&8&&(a.$$scope={dirty:l,ctx:i}),!n&&l[0]&1&&(n=!0,a.open=i[0],ae(()=>n=!1)),e.$set(a)},i(i){t||(O(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){q(e,i),f=!1,d()}}}function Ae(s,e){return s.getContext("2d").drawImage(e,0,0,s.width,s.height),new Promise(t=>{s.toBlob(t)})}function He(s){const e=new MediaRecorder(s),n=[];return e.addEventListener("dataavailable",function(t){t.data.size>0&&n.push(t.data)}),e.start(),()=>new Promise(t=>{e.addEventListener("stop",()=>{t(new Blob(n))}),e.stop()})}function ze(s,e,n){let t,{open:f=!1}=e,{audio:d=!1}=e,{video:m=!1}=e,{width:p=0}=e,{height:i=0}=e,{mediaStream:l=void 0}=e,{player:a=void 0}=e,{canvas:c=void 0}=e;const h=Me();let k=!1,M=!1,u,g;function E(){n(0,f=!1)}function W(){F=F>=X.length-1?0:F+1,$()}function J(r){r.type==="mousedown"&&r.button!==0||k||(n(7,k=!0),m&&(u=setTimeout(()=>{k&&(n(8,M=!0),g=He(l)),u=void 0},500)))}function o(){k&&(n(7,k=!1),u&&(clearTimeout(u),u=void 0),M?(n(8,M=!1),K()):v())}function v(){ce().then(()=>Ae(c,a)).then(r=>h("image",r))}function K(){ce().then(g).then(r=>h("video",r))}Se(()=>(window.document.addEventListener("mouseup",o),window.document.addEventListener("mouseleave",o),()=>{window.document.removeEventListener("mouseup",o),window.document.removeEventListener("mouseleave",o),U()}));function U(){l&&(l.getTracks().forEach(r=>r.stop()),n(12,l=void 0),n(3,a.srcObject=void 0,a))}function Q(){navigator.mediaDevices.enumerateDevices().then(r=>r.filter(G=>G.kind==="videoinput")).then(r=>{X=r,F>=X.length&&(F=0),$()})}let A=!1;function $(){var r;A||(A=!0,U(),navigator.mediaDevices.getUserMedia({video:{deviceId:(r=X[F])==null?void 0:r.deviceId},audio:d}).then(G=>{let oe=!1,ee=0,te=0;G.getVideoTracks().forEach(ne=>{const ue=ne.getSettings();ee=Math.max(ee,ue.width),te=Math.max(te,ue.height),ne.muted&&(oe=ne.muted)}),oe?(W(),$()):(n(15,D=ee),n(16,L=te),n(12,l=G),n(3,a.srcObject=G,a),n(17,t=D>H||L>z?Math.min(H/D,z/L):1),n(1,p=D*t),n(2,i=L*t))}).finally(()=>{A=!1}))}let H,z,D=1,L=1,X=[],F=0;function _e(){n(5,H=le.innerWidth),n(6,z=le.innerHeight)}function he(r){Y[r?"unshift":"push"](()=>{c=r,n(4,c)})}function pe(r){Y[r?"unshift":"push"](()=>{a=r,n(3,a)})}function ge(r){f=r,n(0,f)}return s.$$set=r=>{"open"in r&&n(0,f=r.open),"audio"in r&&n(13,d=r.audio),"video"in r&&n(14,m=r.video),"width"in r&&n(1,p=r.width),"height"in r&&n(2,i=r.height),"mediaStream"in r&&n(12,l=r.mediaStream),"player"in r&&n(3,a=r.player),"canvas"in r&&n(4,c=r.canvas)},s.$$.update=()=>{s.$$.dirty[0]&4097&&f&&!l&&typeof navigator.mediaDevices!="undefined"&&Q(),s.$$.dirty[0]&4097&&!f&&l&&U(),s.$$.dirty[0]&98400&&n(17,t=D>H||L>z?Math.min(H/D,z/L):1),s.$$.dirty[0]&163840&&n(1,p=D*t),s.$$.dirty[0]&196608&&n(2,i=L*t)},[f,p,i,a,c,H,z,k,M,E,W,J,l,d,m,D,L,t,_e,he,pe,ge]}class Fe extends se{constructor(e){super();ie(this,e,ze,We,fe,{open:0,audio:13,video:14,width:1,height:2,mediaStream:12,player:3,canvas:4},null,[-1,-1])}}function de(s){let e,n;return{c(){e=C("img"),this.h()},l(t){e=y(t,"IMG",{src:!0,class:!0}),this.h()},h(){x(e.src,n=s[1])||b(e,"src",n),b(e,"class","svelte-rqyyga")},m(t,f){w(t,e,f)},p(t,f){f&2&&!x(e.src,n=t[1])&&b(e,"src",n)},d(t){t&&_(e)}}}function me(s){let e,n;return{c(){e=C("video"),this.h()},l(t){e=y(t,"VIDEO",{src:!0,class:!0}),S(e).forEach(_),this.h()},h(){x(e.src,n=s[2])||b(e,"src",n),e.controls=!0,b(e,"class","svelte-rqyyga")},m(t,f){w(t,e,f)},p(t,f){f&4&&!x(e.src,n=t[2])&&b(e,"src",n)},d(t){t&&_(e)}}}function Ge(s){let e,n,t,f,d,m,p,i,l,a,c=s[1]&&de(s),h=s[2]&&me(s);function k(u){s[6](u)}let M={video:!0};return s[0]!==void 0&&(M.open=s[0]),m=new Fe({props:M}),Y.push(()=>re(m,"open",k)),m.$on("image",s[4]),m.$on("video",s[5]),{c(){e=C("button"),n=Ve("Capture"),t=I(),c&&c.c(),f=I(),h&&h.c(),d=I(),R(m.$$.fragment)},l(u){e=y(u,"BUTTON",{});var g=S(e);n=Ne(g,"Capture"),g.forEach(_),t=T(u),c&&c.l(u),f=T(u),h&&h.l(u),d=T(u),B(m.$$.fragment,u)},m(u,g){w(u,e,g),Z(e,n),w(u,t,g),c&&c.m(u,g),w(u,f,g),h&&h.m(u,g),w(u,d,g),j(m,u,g),i=!0,l||(a=P(e,"click",s[3]),l=!0)},p(u,[g]){u[1]?c?c.p(u,g):(c=de(u),c.c(),c.m(f.parentNode,f)):c&&(c.d(1),c=null),u[2]?h?h.p(u,g):(h=me(u),h.c(),h.m(d.parentNode,d)):h&&(h.d(1),h=null);const E={};!p&&g&1&&(p=!0,E.open=u[0],ae(()=>p=!1)),m.$set(E)},i(u){i||(O(m.$$.fragment,u),i=!0)},o(u){V(m.$$.fragment,u),i=!1},d(u){u&&_(e),u&&_(t),c&&c.d(u),u&&_(f),h&&h.d(u),u&&_(d),q(m,u),l=!1,a()}}}function Je(s,e,n){let t=!1;function f(){n(0,t=!0)}let d;function m(a){n(1,d=URL.createObjectURL(a.detail)),n(0,t=!1)}let p;function i(a){n(2,p=URL.createObjectURL(a.detail)),n(0,t=!1)}function l(a){t=a,n(0,t)}return[t,d,p,f,m,i,l]}class Qe extends se{constructor(e){super();ie(this,e,Je,Ge,fe,{})}}export{Qe as default};
